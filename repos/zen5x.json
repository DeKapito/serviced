{
  "Name": "Zenoss",
  "Description": "Zenoss Resource Manager",
  "Launch": "auto",
  "Services": [{
      "Command": "",
      "Endpoints": [],
      "ImageId": "",
      "Instances": {
        "min": 0
      },
      "Launch": "auto",
      "Name": "Zenoss",
      "Services":
      [{
          "Name": "MySQL",
          "Tags": ["daemon"],
          "Command": "/usr/bin/mysqld_safe",
          "Endpoints": [{
              "Application": "mysql",
              "PortNumber": 3306,
              "Protocol": "tcp",
              "Purpose": "export"
            }
          ],
          "LogConfigs": [{
              "path":"/var/log/mysqld.log",
              "type": "mysql"
          }],
          "ImageId": "zenoss/zenoss5x",
          "Instances": {
            "min": 1
          },
          "Launch": "auto",
          "Services": []
        }, {
          "Name": "OpenTSDB",
          "Tags": ["daemon"],
          "Command": "/opt/opentsdb/build/start-opentsdb.sh",
          "Endpoints": [{
              "Application": "opentsdb",
              "PortNumber": 4242,
              "Protocol": "tcp",
              "Purpose": "export"
            }
          ],
          "LogConfigs": [{
              "path":"/var/log/supervisor/opentsdb.out.log",
              "type": "opentsdb"
          }],
          "ImageId": "zenoss/opentsdb",
          "Instances": {
            "min": 1
          },
          "Launch": "auto",
          "Services": []
        }, {
          "Name": "RabbitMQ",
          "Tags": ["daemon"],
          "Command": "/usr/sbin/rabbitmq-server",
          "Endpoints": [{
              "Application": "rabbitmq_admin",
              "PortNumber": 15672,
              "Protocol": "tcp",
              "Purpose": "export"
            }, {
              "Application": "rabbitmq",
              "PortNumber": 5672,
              "Protocol": "tcp",
              "Purpose": "export"
            }
          ],
          "LogConfigs": [{
              "path":"/var/log/rabbitmq/rabbit@localhost.log",
              "type": "rabbitmq"
          },{
              "path":"/var/log/rabbitmq/rabbit@localhost-sasl.log",
              "type": "rabbitmq_sasl"
          }],
          "ImageId": "zenoss/zenoss5x",
          "Instances": {
            "min": 1
          },
          "Launch": "auto",
          "Services": []
        }, {
          "Name": "memcached",
          "Tags": ["daemon"],
          "Command": "/usr/bin/memcached",
          "Launch": "auto",
          "Endpoints": [{
              "Application": "memcached",
              "PortNumber": 11211,
              "Protocol": "tcp",
              "Purpose": "export"
            }
          ],
          "ImageId": "zenoss/zenoss5x",
          "Instances": {
            "min": 1
          },
          "Services": []
        }, {
          "Name": "redis",
          "Tags": ["daemon"],
          "Command": "/usr/sbin/redis-server /etc/redis.conf",
          "Launch": "auto",
          "ConfigFiles": {
             "/opt/zenoss/etc/zenping.conf": {
                "FileName": "/opt/zenoss/etc/zenping.conf",
                "Content": "daemonize no\npidfile /var/run/redis/redis.pid\nport 6379\ntimeout 0\ntcp-keepalive 0\nloglevel notice\nlogfile /var/log/redis/redis.log\ndatabases 16\n\nsave 900 1\nsave 300 10\nsave 60 10000\n\nstop-writes-on-bgsave-error yes\nrdbcompression yes\nrdbchecksum yes\ndbfilename dump.rdb\ndir /var/lib/redis/\nslave-serve-stale-data yes\nslave-read-only yes\nrepl-disable-tcp-nodelay no\nslave-priority 100\nappendonly no\nappendfsync everysec\nno-appendfsync-on-rewrite no\nauto-aof-rewrite-percentage 100\nauto-aof-rewrite-min-size 64mb\nlua-time-limit 5000\nslowlog-log-slower-than 10000\nslowlog-max-len 128\nhash-max-ziplist-entries 512\nhash-max-ziplist-value 64\nlist-max-ziplist-entries 512\nlist-max-ziplist-value 64\nset-max-intset-entries 512\nzset-max-ziplist-entries 128\nzset-max-ziplist-value 64\nactiverehashing yes\nclient-output-buffer-limit normal 0 0 0\nclient-output-buffer-limit slave 256mb 64mb 60\nclient-output-buffer-limit pubsub 32mb 8mb 60\nhz 10\naof-rewrite-incremental-fsync yes\n"}},
          "Endpoints": [{
              "Application": "redis",
              "PortNumber": 6379,
              "Protocol": "tcp",
              "Purpose": "export"
            }
          ],
          "LogConfigs": [{
              "path":"/var/log/redis/redis.log",
              "type": "redis"
          }],
          "ImageId": "zenoss/zenoss5x",
          "Instances": {
            "min": 1
          },
          "Services": []
        }, {
          "Name": "zsupervisord",
          "Tags": ["daemon"],
          "Command": "redis-server /etc/redis.conf & su - zenoss -c \"cd /opt/zenoss && /bin/supervisord -c etc/zsupervisor.conf -n\"",
          "Endpoints": [{
              "Application": "memcached",
              "PortNumber": 11211,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "zope",
              "PortNumber": 9080,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "opentsdb",
              "PortNumber": 4242,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "metric_consumer",
              "PortNumber": 8443,
              "Protocol": "tcp",
              "Purpose": "export"
            }, {
              "Application": "central_query",
              "PortNumber": 8888,
              "Protocol": "tcp",
              "Purpose": "export"
            }, {
              "Application": "zproxy",
              "PortNumber": 8080,
              "Protocol": "tcp",
              "Purpose": "export"
            }, {
              "Application": "zauth",
              "PortNumber": 9180,
              "Protocol": "tcp",
              "Purpose": "export"
            }
          ],
          "LogConfigs": [{
              "path":"/opt/zenoss/log/supervisord.log",
              "type": "zsupervisor"
          }],
          "ImageId": "zenoss/zenoss5x",
          "Instances": {
            "min": 1
          },
          "Launch": "auto",
          "Services": []
        }, {
          "Name": "zeneventserver",
          "Tags": ["daemon"],
          "Command": "su - zenoss -c \"/opt/zenoss/bin/zeneventserver run -v10\"",
          "Endpoints": [{
              "Application": "mysql",
              "PortNumber": 3306,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "memcached",
              "PortNumber": 11211,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "redis",
              "PortNumber": 6379,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "rabbitmq",
              "PortNumber": 5672,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "zep",
              "PortNumber": 8084,
              "Protocol": "tcp",
              "Purpose": "export"
            }
          ],
          "LogConfigs": [{
              "path":"/opt/zenoss/log/zeneventserver.log",
              "type": "zeneventserver"
          },{
              "path":"/opt/zenoss/log/zeneventserver-stdio*.log",
              "type": "zeneventserver_stdio"
          }],
          "ImageId": "zenoss/zenoss5x",
          "Instances": {
            "min": 1
          },
          "Launch": "auto",
          "Services": []
        }, {
          "Name": "Zope",
          "Tags": ["daemon"],
          "Command": "su - zenoss -c \"/opt/zenoss/bin/zopectl fg\"",
          "Endpoints": [{
              "Application": "rabbitmq_admin",
              "PortNumber": 15672,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "mysql",
              "PortNumber": 3306,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "memcached",
              "PortNumber": 11211,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "redis",
              "PortNumber": 6379,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "rabbitmq",
              "PortNumber": 5672,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "zep",
              "PortNumber": 8084,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "zope",
              "PortNumber": 9080,
              "Protocol": "tcp",
              "Purpose": "export"
            }
          ],
          "LogConfigs": [{
              "path":"/opt/zenoss/log/event.log",
              "type": "zope_eventlog"
          },{
              "path":"/opt/zenoss/log/Z2.log",
              "type": "zope_access_logs"
          }],
          "ImageId": "zenoss/zenoss5x",
          "Instances": {
            "min": 1
          },
          "Launch": "auto",
          "Services": []
        }, {
          "Name": "ZenJobs",
          "Tags": ["daemon"],
          "Command": "su - zenoss -c \"/opt/zenoss/bin/zenjobs run -v10\"",
          "Endpoints": [{
              "Application": "rabbitmq_admin",
              "PortNumber": 15672,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "mysql",
              "PortNumber": 3306,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "memcached",
              "PortNumber": 11211,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "redis",
              "PortNumber": 6379,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "rabbitmq",
              "PortNumber": 5672,
              "Protocol": "tcp",
              "Purpose": "import"
            }
          ],
          "LogConfigs": [{
              "path":"/opt/zenoss/log/zenjobs.log",
              "type": "zenjobs"
          }],
          "ImageId": "zenoss/zenoss5x",
          "Instances": {
            "min": 1
          },
          "Launch": "auto",
          "Services": []
        }, {
          "Name": "ZenEventd",
          "Tags": ["daemon"],
          "Command": "su - zenoss -c \"/opt/zenoss/bin/zeneventd run -v10\"",
          "Endpoints": [{
              "Application": "mysql",
              "PortNumber": 3306,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "memcached",
              "PortNumber": 11211,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "redis",
              "PortNumber": 6379,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "rabbitmq",
              "PortNumber": 5672,
              "Protocol": "tcp",
              "Purpose": "import"
            }
          ],
          "LogConfigs": [{
              "path":"/opt/zenoss/log/zeneventd.log",
              "type": "zeneventd"
          }],
          "ImageId": "zenoss/zenoss5x",
          "Instances": {
            "min": 1
          },
          "Launch": "auto",
          "Services": []
        }, {
          "Name": "ZenActiond",
          "Tags": ["daemon"],
          "Command": "su - zenoss -c \"/opt/zenoss/bin/zenactiond run -v10\"",
          "Endpoints": [{
              "Application": "mysql",
              "PortNumber": 3306,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "memcached",
              "PortNumber": 11211,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "redis",
              "PortNumber": 6379,
              "Protocol": "tcp",
              "Purpose": "import"
            }, {
              "Application": "rabbitmq",
              "PortNumber": 5672,
              "Protocol": "tcp",
              "Purpose": "import"
            }
          ],
          "LogConfigs": [{
              "path":"/opt/zenoss/log/zenactiond.log",
              "type": "zenactiond"
          }],
          "ImageId": "zenoss/zenoss5x",
          "Instances": {
            "min": 1
          },
          "Launch": "auto",
          "Services": []
        }, {
          "Name": "localhost",
          "Tags": ["hub"],
          "Endpoints": [],
          "Instances": {
            "min": 0
          },
          "Launch": "auto",
          "Services": [{
              "Name": "ZenHub",
              "Tags": ["daemon", "hub"],
              "Command": "su - zenoss -c \"/opt/zenoss/bin/zenhub run -v10\"",
              "Endpoints": [{
                  "Application": "mysql",
                  "PortNumber": 3306,
                  "Protocol": "tcp",
                  "Purpose": "import"
                }, {
                  "Application": "memcached",
                  "PortNumber": 11211,
                  "Protocol": "tcp",
                  "Purpose": "import"
                }, {
                  "Application": "redis",
                  "PortNumber": 6379,
                  "Protocol": "tcp",
                  "Purpose": "import"
                }, {
                  "Application": "rabbitmq",
                  "PortNumber": 5672,
                  "Protocol": "tcp",
                  "Purpose": "import"
                }, {
                  "Application": "zenhubPB",
                  "PortNumber": 8789,
                  "Protocol": "tcp",
                  "Purpose": "export"
                }, {
                  "Application": "zenhubXMLRpc",
                  "PortNumber": 8781,
                  "Protocol": "tcp",
                  "Purpose": "export"
                }
              ],
              "LogConfigs": [{
                  "path":"/opt/zenoss/log/zenhub.log",
                  "type": "zenhub"
              }],
              "ImageId": "zenoss/zenoss5x",
              "Instances": {
                "min": 1
              },
              "Launch": "auto",
              "Services": []
            }, {
              "Name": "localhost",
              "Tags": ["collector"],
              "Endpoints": [],
              "Instances": {
                "min": 0
              },
              "Launch": "auto",
              "Services": [{
                  "Name": "zenperfsnmp",
                  "Tags": ["daemon", "collector"],
                  "Command": "su - zenoss -c \"/opt/zenoss/bin/zenperfsnmp run -c -v10\"",
                  "Launch": "auto",
                  "Endpoints": [{
                      "Application": "zenhubPB",
                      "PortNumber": 8789,
                      "Protocol": "tcp",
                      "Purpose": "import"
                    }, {
                      "Application": "redis",
                      "PortNumber": 6379,
                      "Protocol": "tcp",
                      "Purpose": "import"
                    }
                  ],
                  "LogConfigs": [{
                      "path":"/opt/zenoss/log/zenperfsnmp.log",
                      "type": "zenperfsnmp"
                  }],
                  "ImageId": "zenoss/zenoss5x",
                  "Instances": {
                    "min": 1
                  },
                  "Services": []
                }, {
                  "Name": "zenmodeler",
                  "Tags": ["daemon", "collector"],
                  "Command": "su - zenoss -c \"/opt/zenoss/bin/zenmodeler run -c -v10\"",
                  "Launch": "auto",
                  "Endpoints": [{
                      "Application": "zenhubPB",
                      "PortNumber": 8789,
                      "Protocol": "tcp",
                      "Purpose": "import"
                    }, {
                      "Application": "redis",
                      "PortNumber": 6379,
                      "Protocol": "tcp",
                      "Purpose": "import"
                    }
                  ],
                  "LogConfigs": [{
                      "path":"/opt/zenoss/log/zenmodeler.log",
                      "type": "zenmodeler"
                  }],
                  "ImageId": "zenoss/zenoss5x",
                  "Instances": {
                    "min": 1
                  },
                  "Services": []
                }, {
                  "Name": "zenprocess",
                  "Tags": ["daemon", "collector"],
                  "Command": "su - zenoss -c \"/opt/zenoss/bin/zenprocess run -c -v10\"",
                  "Launch": "auto",
                  "Endpoints": [{
                      "Application": "zenhubPB",
                      "PortNumber": 8789,
                      "Protocol": "tcp",
                      "Purpose": "import"
                    }, {
                      "Application": "redis",
                      "PortNumber": 6379,
                      "Protocol": "tcp",
                      "Purpose": "import"
                    }
                  ],
                  "LogConfigs": [{
                      "path":"/opt/zenoss/log/zenprocess.log",
                      "type": "zenprocess"
                  }],
                  "ImageId": "zenoss/zenoss5x",
                  "Instances": {
                    "min": 1
                  },
                  "Services": []
                }, {
                  "Name": "zenping",
                  "Tags": ["daemon", "collector"],
                  "Command": "su - zenoss -c \"/opt/zenoss/bin/zenping run -c -v10\"",
                  "Launch": "auto",
                  "ConfigFiles": {
                      "/opt/zenoss/etc/zenping.conf": {
                          "FileName": "/opt/zenoss/etc/zenping.conf",
                          "Content":  "#\n# Configuration file for zenping\n#\n#  To enable a particular option, uncomment the desired entry.\n#\n# Parameter     Setting\n# ---------     -------\n#\n# Maximum number of collection worker\n#  processes, default: 1\n#workers 1\n#\n# Target number of devices per worker,\n#  default: 0\n#devicesPerWorker 0\n#\n# Host of zenhub daemon. Default is localhost.,\n#  default: localhost\n#hubhost localhost\n#\n# Port zenhub listens on.Default is 8789.,\n#  default: 8789\n#hubport 8789\n#\n# Username for zenhub login. Default is\n#  admin., default: admin\n#hubusername admin\n#\n# Password for zenhub login. Default is\n#  zenoss., default: zenoss\n#hubpassword zenoss\n#\n# Name of monitor instance to use for\n#  configuration.  Default is localhost.,\n#  default: localhost\n#monitor localhost\n#\n# Initial time to wait for a ZenHub connection,\n#  default: 30\n#initialHubTimeout 30\n#\n# Send clear events even when the most\n#  recent event was also a clear event.,\n#  default: False\n#allowduplicateclears False\n#\n# Send a clear event every [DUPLICATECLEARINTEVAL]\n#  events., default: 0\n#duplicateclearinterval 0\n#\n# Seconds between attempts to flush events\n#  to ZenHub., default: 5.0\n#eventflushseconds 5.0\n#\n# Number of events to send to ZenHubat\n#  one time, default: 50\n#eventflushchunksize 50\n#\n# Maximum number of events to queue, default:\n#  5000\n#maxqueuelen 5000\n#\n# How often to ping zenhub, default: 30\n#zenhubpinginterval 30\n#\n# Disable event de-duplication, default: True\n#disable-event-deduplication True\n#\n# redis connection string: redis://[hostname]:[port]/[db],\n#  default: %default, default:\n#  redis://localhost:6379/0\n#redis-url redis://localhost:6379/0\n#\n# Number of metrics to buffer if redis\n#  goes down, default: 65536\n#metricBufferSize 65536\n#\n# redis channel to which metrics are published,\n#  default: metrics\n#metricsChannel metrics\n#\n# Use an alternate configuration file\n#configfile /opt/zenoss/etc/zenping.conf\n#\n# Generate an XML file containing command-line\n#  switches., default: False\n#genxmlconfigs False\n#\n# User to become when running default:zenoss,\n#  default: zenoss\n#uid zenoss\n#\n# Cycle continuously on cycleInterval\n#  from Zope, default: False\n#cycle False\n#\n# Launch into the background, default: False\n#daemon False\n#\n# Log to console and log file, default: False\n#duallog False\n#\n# output log info in HTML table format,\n#  default: False\n#weblog False\n#\n# Run under a supervisor which will restart\n#  it, default: False\n#watchdog False\n#\n# The path to the watchdog reporting socket\n#watchdogPath None\n#\n# Wait seconds for initial heartbeat\n#starttimeout None\n#\n# Set listener socket options. For option\n#  details: man 7 socket, default: []\n#socketOption []\n#\n# Specify a device ID to monitor\n#device \n#\n# Max number of tasks to run at once,\n#  default %default, default: 500\n#maxparallel 500\n#\n# How often to logs statistics of current\n#  tasks, value in seconds; very verbose,\n#  default: 0\n#logTaskStats 0\n#\n# How often to write internal statistics\n#  value in seconds, default: 60\n#writeStatistics 60\n#\n# Max number of device configurations\n#  to load at once, default %default (0\n#  == all devices), default: 25\n#configsipsize 25\n#\n# Delay in seconds between device configurations\n#  loading, default %default, default: 1\n#configsipdelay 1\n#\n# Disable the correlator., default: True\n#disable-correlator True\n#\n# Traceroute every N ping intervals; default\n#  is 5, traceroute every time a ping\n#  is performed., default: 5\n#traceroute-interval 5\n#\n# Length of datapacket for zenping to\n#  use (default: %default), default: 0\n#data-length 0\n#\n# Delay down events until more than this\n#  many ping downs are collected in a\n#  row. Default is 0 (no delay)., default: 0\n#delay-count 0\n#\n# Use ip's connected to a device for ping\n#  correlation (default: %default), default:\n#  disabled\n#connected-ips disabled\n#\n# ping backend to use (nmap, ping) default:\n#  %default, default: nmap\n#ping-backend nmap\n#\n# Correlationbackend to use (simple, distributed)\n#  default: %default, default: distributed\n#correlation-backend distributed\n#\n# Suppress ping downs using interfaces\n#  on a device whose IPs may not be monitored,\n#  default: False\n#connected-ip-suppress False\n#\n# Logging severity threshold, default: 20\n#logseverity 20\n#\n# Override the default logging path\n#logpath None\n#\n# Max size of log file in KB; default\n#  10240, default: 10240\n#maxlogsize 10240\n#\n# Max number of back up log files; default\n#  3, default: 3\n#maxbackuplogs 3\n#\n"
                  }},
                  "Endpoints": [{
                      "Application": "zenhubPB",
                      "PortNumber": 8789,
                      "Protocol": "tcp",
                      "Purpose": "import"
                    }, {
                      "Application": "redis",
                      "PortNumber": 6379,
                      "Protocol": "tcp",
                      "Purpose": "import"
                    }
                  ],
                  "LogConfigs": [{
                      "path":"/opt/zenoss/log/zenping.log",
                      "type": "zenping"
                  }],
                  "ImageId": "zenoss/zenoss5x",
                  "Instances": {
                    "min": 1
                  },
                  "Services": []
                }, {
                  "Name": "zencommand",
                  "Tags": ["daemon", "collector"],
                  "Command": "su - zenoss -c \"/opt/zenoss/bin/zencommand run -c -v10\"",
                  "Launch": "auto",
                  "Endpoints": [{
                      "Application": "zenhubPB",
                      "PortNumber": 8789,
                      "Protocol": "tcp",
                      "Purpose": "import"
                    }, {
                      "Application": "redis",
                      "PortNumber": 6379,
                      "Protocol": "tcp",
                      "Purpose": "import"
                    }
                  ],
                  "LogConfigs": [{
                      "path":"/opt/zenoss/log/zencommand.log",
                      "type": "zencommand"
                  }],
                  "ImageId": "zenoss/zenoss5x",
                  "Instances": {
                    "min": 1
                  },
                  "Services": []
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}

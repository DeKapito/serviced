<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en-us">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="UTF-8"><meta name="copyright" content="(C) Copyright 2014">
<meta name="DC.rights.owner" content="(C) Copyright 2014">
<meta name="DC.Type" content="task">
<meta name="prodname" content="Control Center">
<meta name="version" content="0">
<meta name="release" content="8">
<meta name="modification" content="0">
<meta name="DC.Publisher" content="Zenoss, Inc.">
<meta name="DC.Format" content="XHTML">
<meta name="DC.Identifier" content="taskid">
<link rel="stylesheet" type="text/css" href="../commonltr.css">
<title>Converting a single-host deployment to multi-host</title>
</head>
<body id="taskid">


  <h1 class="title topictitle1">Converting a single-host deployment to multi-host</h1>

  <div class="body taskbody">
    <div class="section context">You may add hosts to a single-host deployment by
    following the steps in this procedure.</div>

    <ol class="ol steps"><li class="li step stepexpand">
        <span class="ph cmd">Install <span class="ph">Control Center</span> on resource pool hosts.</span>
        
      </li>
<li class="li step stepexpand">
        <span class="ph cmd">Log in to the <span class="ph">Control Center</span> web interface, and then stop all applications.</span>
      </li>
<li class="li step stepexpand">
        <span class="ph cmd">Log in to the master host.</span>
        <ul class="ul choices">
          <li class="li choice">For Ubuntu hosts, log in as a user with <samp class="ph codeph">sudo</samp> and <samp class="ph codeph">docker</samp> privileges.</li>

          <li class="li choice">For RHEL or CentOS hosts, log in as <samp class="ph codeph">root</samp>.</li>

        </ul>

      </li>
<li class="li step stepexpand">
        <span class="ph cmd">Stop the <span class="keyword cmdname">serviced</span> daemon.</span>
        <ul class="ul choices">
          <li class="li choice">Ubuntu: <kbd class="ph userinput">sudo stop serviced</kbd></li>

          <li class="li choice">RHEL/CentOS: <kbd class="ph userinput">systemctl stop serviced</kbd></li>

        </ul>

      </li>
<li class="li step stepexpand">
        <span class="ph cmd">Configure the master host for multi-host deployment.</span>
        <div class="itemgroup info">
          <p class="p">To enable a multi-host deployment, uncomment and change the following variables.</p>

        <dl class="dl">
          
            <dt class="dt dlterm">SERVICED_REGISTRY</dt>

            <dd class="dd">Determines whether <span class="keyword cmdname">serviced</span> uses a local registry to store 
              Docker images. Set the value to 1, true.</dd>

          
          
            <dt class="dt dlterm">SERVICED_AGENT</dt>

            <dd class="dd">Determines whether a <span class="keyword cmdname">serviced</span> instance acts as
              a resource pool host. A resource pool host runs application services 
              scheduled for the resource pool to which it belongs. Set the value to 1, true.</dd>

          
          
            <dt class="dt dlterm">SERVICED_MASTER</dt>

            <dd class="dd">Determines whether a <span class="keyword cmdname">serviced</span> instance acts as the <span class="ph">Control Center</span> master host. The master host runs the application services
                scheduler and other internal services, including the web server for the <span class="ph">Control Center</span> web interface. A <span class="keyword cmdname">serviced</span> instance may
                be configured as both an agent and a master. Set the value to 1, true.</dd>

          
        </dl>

        <p class="p">The following commands make the required edits to <span class="ph filepath">/etc/default/serviced</span>.</p>

        </div>
        <div class="itemgroup stepxmp"><pre class="pre codeblock">EXT=$(date +"%j-%H%M%S")
sudo sed -i.${EXT} -e 's|^#[^S]*\(SERVICED_REGISTRY=\).|\11|' \
  -e 's|^#[^S]*\(SERVICED_AGENT=\).|\11|' \
  -e 's|^#[^S]*\(SERVICED_MASTER=\).|\11|' \
  /etc/default/serviced</pre>
</div>
      </li>
<li class="li step stepexpand">
        <span class="ph cmd">Start <span class="keyword cmdname">serviced</span>.</span>
        <ul class="ul choices">
          <li class="li choice">Ubuntu: <kbd class="ph userinput">sudo start serviced</kbd></li>

          <li class="li choice">RHEL/CentOS: <kbd class="ph userinput">systemctl start serviced</kbd></li>

        </ul>

      </li>
<li class="li step stepexpand">
        <span class="ph cmd">Synchronize the local Docker registry with the resource pool hosts.</span>
        <ul class="ul choices">
          <li class="li choice">Ubuntu: <kbd class="ph userinput">sudo serviced docker sync</kbd></li>

          <li class="li choice">RHEL/CentOS: <kbd class="ph userinput">serviced docker sync</kbd></li>

        </ul>

      </li>
<li class="li step stepexpand">
        <span class="ph cmd">In the <span class="ph">Control Center</span> web interface,
        start applications.</span>
      </li>
</ol>

  </div>


</body>
</html>